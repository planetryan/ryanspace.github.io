"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["33"],{1991:function(e,t,a){a.r(t),a.d(t,{PlanDetails:()=>p});var n=a(8635),i=a(3799),r=a(9144),o=a(8969),l=a(3812),c=a(3064),s=a(3805),d=a(43);let p=e=>(0,n.tZ)(l.SubscriberTypeContext.Provider,{value:e.subscriberType||"user",children:(0,n.tZ)(l.PlansContextProvider,{children:(0,n.tZ)(m,{...e})})}),m=({plan:e,onSubscriptionCancel:t,portalRoot:a,planPeriod:p="month"})=>{let m=(0,i.cL)(),{organization:h}=(0,i.o8)(),[g,D]=(0,r.useState)(!1),[b,x]=(0,r.useState)(!1),[y,B]=(0,r.useState)(),[Z,S]=(0,r.useState)(p),{setIsOpen:C}=(0,s.useDrawerContext)(),{activeOrUpcomingSubscription:v,revalidate:k,buttonPropsForPlan:w,isDefaultPlanImplicitlyActiveOrUpcoming:T}=(0,l.usePlansContext)(),z=(0,l.useSubscriberTypeContext)(),f=(0,o.N2)(e=>e({permission:"org:sys_billing:manage"})||"user"===z);if(!e)return null;let P=v(e),K=()=>{C&&C(!1)},$=e.features,F=$.length>0,L=async()=>{P&&(B(void 0),x(!0),await P.cancel({orgId:"org"===z?h?.id:void 0}).then(()=>{x(!1),t?.(),K()}).catch(e=>{(0,d.S3)(e,[],B),x(!1)}))},X=t=>{K();let n=t?.planPeriod||Z;"annual"===n&&0===e.annualMonthlyAmount&&(n="month"),m.__internal_openCheckout({planId:e.id,planPeriod:n,subscriberType:z,onSubscriptionComplete:()=>{k()},portalRoot:a})};return(0,n.BX)(s.Drawer.Content,{children:[(0,n.tZ)(s.Drawer.Header,{sx:e=>F?null:{flex:1,borderBottomWidth:0,background:e.colors.$colorBackground},children:(0,n.tZ)(u,{plan:e,subscription:P,planPeriod:Z,setPlanPeriod:S,closeSlot:(0,n.tZ)(s.Drawer.Close,{})})}),F?(0,n.BX)(s.Drawer.Body,{children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:(0,c.localizationKeys)("commerce.availableFeatures"),colorScheme:"secondary",sx:e=>({padding:e.space.$4,paddingBottom:0})}),(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesList,as:"ul",role:"list",sx:e=>({display:"grid",rowGap:e.space.$6,padding:e.space.$4,margin:0}),children:$.map(e=>(0,n.BX)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesListItem,as:"li",sx:e=>({display:"flex",alignItems:"baseline",gap:e.space.$3}),children:[e.avatarUrl?(0,n.tZ)(s.Avatar,{size:e=>24,title:e.name,initials:e.name[0],rounded:!1,imageUrl:e.avatarUrl}):null,(0,n.BX)(c.Span,{elementDescriptor:c.descriptors.planDetailFeaturesListItemContent,children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemTitle,colorScheme:"body",sx:e=>({fontWeight:e.fontWeights.$medium}),children:e.name}),e.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemDescription,colorScheme:"secondary",sx:e=>({marginBlockStart:e.space.$0x25}),children:e.description}):null]})]},e.id))})]}):null,e.isDefault&&T?null:(0,n.tZ)(s.Drawer.Footer,{children:P?P.canceledAt?(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...w({plan:e}),onClick:()=>X()}):(0,n.BX)(c.Col,{gap:4,children:[P&&"month"===P.planPeriod&&e.annualMonthlyAmount>0?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!f,onClick:()=>X({planPeriod:"annual"}),localizationKey:(0,c.localizationKeys)("commerce.switchToAnnual")}):null,P&&"annual"===P.planPeriod?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!f,onClick:()=>X({planPeriod:"month"}),localizationKey:(0,c.localizationKeys)("commerce.switchToMonthly")}):null,(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"danger",textVariant:"buttonLarge",isDisabled:!f,onClick:()=>D(!0),localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}):(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...w({plan:e}),onClick:()=>X()})}),P?(0,n.BX)(s.Drawer.Confirmation,{open:g,onOpenChange:D,actionsSlot:(0,n.BX)(n.HY,{children:[!b&&(0,n.tZ)(c.Button,{variant:"ghost",size:"sm",textVariant:"buttonLarge",isDisabled:!f,onClick:()=>{B(void 0),D(!1)},localizationKey:(0,c.localizationKeys)("commerce.keepSubscription")}),(0,n.tZ)(c.Button,{variant:"solid",colorScheme:"danger",size:"sm",textVariant:"buttonLarge",isLoading:b,isDisabled:!f,onClick:()=>{B(void 0),D(!1),L()},localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}),children:[(0,n.BX)(c.Heading,{elementDescriptor:c.descriptors.drawerConfirmationTitle,as:"h2",textVariant:"h3",children:["Cancel ","upcoming"===P.status?"upcoming ":"",P.plan.name," Subscription?"]}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.drawerConfirmationDescription,colorScheme:"secondary",children:"upcoming"===P.status?(0,n.tZ)(n.HY,{children:"You will not be charged for this subscription."}):(0,n.BX)(n.HY,{children:["You can keep using “",P.plan.name,"” features until"," ",(0,d.p6)(new Date(P.periodEnd)),", after which you will no longer have access."]})}),y&&(0,n.tZ)(s.Alert,{colorScheme:"danger",children:"string"==typeof y?y:y.message})]}):null]})},u=r.forwardRef((e,t)=>{let{plan:a,subscription:i,closeSlot:r,planPeriod:o,setPlanPeriod:d}=e,{captionForSubscription:p,isDefaultPlanImplicitlyActiveOrUpcoming:m,subscriptions:u}=(0,l.usePlansContext)(),h=m&&a.isDefault,g=!!i||h;return(0,n.BX)(c.Box,{ref:t,elementDescriptor:c.descriptors.planDetailHeader,sx:e=>({width:"100%",padding:e.space.$4,position:"relative"}),children:[r?(0,n.tZ)(c.Box,{sx:e=>({position:"absolute",top:e.space.$2,right:e.space.$2}),children:r}):null,a.avatarUrl?(0,n.tZ)(s.Avatar,{boxElementDescriptor:c.descriptors.planDetailAvatar,size:e=>40,title:a.name,initials:a.name[0],rounded:!1,imageUrl:a.avatarUrl,sx:e=>({marginBlockEnd:e.space.$3})}):null,(0,n.BX)(c.Box,{sx:e=>({paddingRight:e.space.$10}),children:[(0,n.BX)(c.Flex,{gap:2,align:"center",children:[(0,n.tZ)(c.Heading,{elementDescriptor:c.descriptors.planDetailTitle,as:"h2",textVariant:"h2",children:a.name}),g?(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailBadgeContainer,children:i?.status==="active"||h&&0===u.length?(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__activePlan"),colorScheme:"secondary"}):(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__upcomingPlan"),colorScheme:"primary"})}):null]}),a.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailDescription,variant:"subtitle",colorScheme:"secondary",sx:e=>({marginTop:e.space.$1}),children:a.description}):null]}),(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailFeeContainer,align:"center",wrap:"wrap",sx:e=>({marginTop:e.space.$3,columnGap:e.space.$1x5}),children:(0,n.BX)(n.HY,{children:[(0,n.BX)(c.Text,{elementDescriptor:c.descriptors.planDetailFee,variant:"h1",colorScheme:"body",children:[a.currencySymbol,i&&"annual"===i.planPeriod||"annual"===o?a.annualMonthlyAmountFormatted:a.amountFormatted]}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeePeriod,variant:"caption",colorScheme:"secondary",sx:e=>({textTransform:"lowercase",":before":{content:'"/"',marginInlineEnd:e.space.$1}}),localizationKey:(0,c.localizationKeys)("commerce.month")})]})}),!i||"month"===i.planPeriod&&a.annualMonthlyAmount>0?(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailPeriodToggle,sx:e=>({display:"flex",marginTop:e.space.$3}),children:(0,n.tZ)(s.Switch,{isChecked:"annual"===o,onChange:e=>d(e?"annual":"month"),label:(0,c.localizationKeys)("commerce.billedAnnually")})}):null,!!i&&(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:p(i),colorScheme:"secondary",sx:e=>({marginTop:e.space.$3})})]})})}}]);