"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["710"],{9817:function(e,t,i){i.r(t),i.d(t,{SignUp:()=>H,SignUpSSOCallback:()=>Z,SignUpContinue:()=>E,SignUpStart:()=>P,SignUpModal:()=>V,SignUpVerifyEmail:()=>B,SignUpVerifyPhone:()=>M});var r=i(8635),a=i(3799),l=i(9144),n=i(7508),s=i(5112),o=i(3812),d=i(3064),c=i(4511),u=i(4676),p=i(3805),m=i(9037),h=i(43),f=i(3423),g=i(1201);let b=e=>{let{handleSubmit:t,fields:i,formState:a,canToggleEmailPhone:l,onlyLegalAcceptedMissing:n=!1,handleEmailPhoneToggle:s}=e,{showOptionalFields:o}=(0,d.useAppearance)().parsedLayout,c=e=>("emailAddress"===e||"phoneNumber"===e)&&l?!!i[e]:!!i[e]&&(o||i[e]?.required);return(0,r.BX)(p.Form.Root,{onSubmit:t,gap:8,children:[!n&&(0,r.BX)(d.Col,{gap:6,children:[(c("firstName")||c("lastName"))&&(0,r.BX)(p.Form.ControlRow,{elementId:"name",sx:{[g.mqu.sm]:{flexWrap:"wrap"}},children:[c("firstName")&&(0,r.tZ)(p.Form.PlainInput,{...a.firstName.props,isRequired:i.firstName?.required,isOptional:!i.firstName?.required}),c("lastName")&&(0,r.tZ)(p.Form.PlainInput,{...a.lastName.props,isRequired:i.lastName?.required,isOptional:!i.lastName?.required})]}),c("username")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"username",children:(0,r.tZ)(p.Form.PlainInput,{...a.username.props,isRequired:i.username?.required,isOptional:!i.username?.required})}),c("emailAddress")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"emailAddress",children:(0,r.tZ)(p.Form.PlainInput,{...a.emailAddress.props,isRequired:i.emailAddress?.required,isOptional:!i.emailAddress?.required,isDisabled:i.emailAddress?.disabled,actionLabel:l?(0,d.localizationKeys)("signUp.start.actionLink__use_phone"):void 0,onActionClicked:l?()=>s("phoneNumber"):void 0})}),c("phoneNumber")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"phoneNumber",children:(0,r.tZ)(p.Form.PhoneInput,{...a.phoneNumber.props,isRequired:i.phoneNumber?.required,isOptional:!i.phoneNumber?.required,actionLabel:l?(0,d.localizationKeys)("signUp.start.actionLink__use_email"):void 0,onActionClicked:l?()=>s("emailAddress"):void 0})}),c("password")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"password",children:(0,r.tZ)(p.Form.PasswordInput,{...a.password.props,isRequired:i.password?.required,isOptional:!i.password?.required})})]}),(0,r.BX)(d.Col,{center:!0,children:[(0,r.tZ)(f.S,{}),(0,r.BX)(d.Col,{gap:6,sx:{width:"100%"},children:[c("legalAccepted")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"legalAccepted",children:(0,r.tZ)(p.LegalCheckbox,{...a.legalAccepted.props,isRequired:i.legalAccepted?.required})}),(0,r.tZ)(p.Form.SubmitButton,{hasArrow:!0,localizationKey:(0,d.localizationKeys)("formButtonPrimary")})]})]})]})};var _=i(5027);let y=["emailAddress","phoneNumber","username","firstName","lastName","password","ticket","legalAccepted"];function A(e){return y.reduce((t,i)=>{let r=function(e,t){switch(e){case"emailAddress":return function({attributes:e,hasTicket:t,hasEmail:i,activeCommIdentifierType:r,isProgressiveSignUp:a}){if(a){if(!((!t||t&&i)&&e.email_address?.enabled)||v(e,a)&&"emailAddress"!==r)return;return{required:!!e.email_address?.required,disabled:!!t&&!!i}}if((!t||t&&i)&&e.email_address?.enabled&&e.email_address?.used_for_first_factor&&"emailAddress"===r)return{required:!0,disabled:!!t&&!!i}}(t);case"phoneNumber":return function({attributes:e,hasTicket:t,activeCommIdentifierType:i,isProgressiveSignUp:r}){if(r){if(!e.phone_number?.enabled||v(e,r)&&"phoneNumber"!==i)return;return{required:!!e.phone_number?.required}}if(!t&&e.phone_number?.enabled&&e.phone_number.used_for_first_factor&&"phoneNumber"===i)return{required:!0}}(t);case"password":return function(e){if(e.password?.enabled&&e.password.required)return{required:!!e.password?.required}}(t.attributes);case"ticket":return function(e){if(e)return{required:!0}}(t.hasTicket);case"legalAccepted":return function(e){if(e)return{required:!0}}(t.legalConsentRequired);case"username":case"firstName":case"lastName":return function(e,t){let i=(0,_.a1)(e);if(t[i]?.enabled)return{required:t[i]?.required}}(e,t.attributes);default:return}}(i,e);return r&&(t[i]=r),t},{})}let U=(e,t)=>{if(v(e,t))return"emailAddress";let{email_address:i,phone_number:r}=e;return(i?.enabled&&t?i.required:i?.used_for_first_factor)?"emailAddress":(r?.enabled&&t?r.required:r?.used_for_first_factor)?"phoneNumber":null};function v(e,t){let{email_address:i,phone_number:r}=e;return!!(t?i?.enabled&&r?.enabled&&!i.required&&!r.required:i?.used_for_first_factor&&r?.used_for_first_factor)}var S=i(138);let C=l.memo(e=>{let t=(0,a.cL)(),{navigate:i}=(0,u.useRouter)(),l=(0,p.useCardState)(),n=(0,o.useSignUpContext)(),s=(0,o.useCoreSignUp)(),d=n.ssoCallbackUrl,c=n.afterSignUpUrl||"/",m="popup"===n.oauthFlow||"auto"===n.oauthFlow&&(0,h.tc)(),{continueSignUp:f=!1,...g}=e;return(0,r.tZ)(S.L,{...g,idleAfterDelay:!m,oauthCallback:t=>{if(m){let i=window.open("about:blank","","width=600,height=800"),r=setInterval(()=>{(!i||i.closed)&&(clearInterval(r),l.setIdle())},500);return s.authenticateWithPopup({strategy:t,redirectUrl:d,redirectUrlComplete:c,popup:i,continueSignUp:f,unsafeMetadata:n.unsafeMetadata,legalAccepted:e.legalAccepted}).catch(e=>(0,h.S3)(e,[],l.setError))}return s.authenticateWithRedirect({continueSignUp:f,redirectUrl:d,redirectUrlComplete:c,strategy:t,unsafeMetadata:n.unsafeMetadata,legalAccepted:e.legalAccepted}).catch(e=>(0,h.S3)(e,[],l.setError))},web3Callback:r=>t.authenticateWithWeb3({customNavigate:i,redirectUrl:c,signUpContinueUrl:"continue",unsafeMetadata:n.unsafeMetadata,strategy:r,legalAccepted:e.legalAccepted}).catch(e=>(0,h.Ht)(e,l.setError))})});var N=i(5756);let E=(0,p.withCardStateProvider)(function(){let e=(0,m.v)(),t=(0,a.cL)(),{navigate:i}=(0,u.useRouter)(),{displayConfig:n,userSettings:s}=(0,o.useEnvironment)(),{attributes:c,usernameSettings:f}=s,{t:g,locale:_}=(0,d.useLocalizations)(),{afterSignUpUrl:y,signInUrl:S,unsafeMetadata:E,initialValues:I={},isCombinedFlow:Z}=(0,o.useSignUpContext)(),R=(0,o.useCoreSignUp)(),z=!!l.useContext(o.SignInContext),L=!!(Z&&z),w=s.signUp.progressive,[F,K]=l.useState(U(c,s.signUp.progressive)),P={firstName:(0,h.Yp)("firstName",I.firstName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,h.Yp)("lastName",I.lastName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,h.Yp)("emailAddress",I.emailAddress||R.emailAddress||"",{type:"email",label:(0,d.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,h.Yp)("username",I.username||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__username"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,h.fq)(e,{t:g,locale:_,usernameSettings:f})}),phoneNumber:(0,h.Yp)("phoneNumber",I.phoneNumber||"",{type:"tel",label:(0,d.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),password:(0,h.Yp)("password","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__password"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0}),legalAccepted:(0,h.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:s.signUp.legal_consent_enabled||!1})},k=(0,l.useMemo)(()=>R.missingFields&&1===R.missingFields.length&&"legal_accepted"===R.missingFields[0]&&R.unverifiedFields&&0===R.unverifiedFields.length,[R.missingFields,R.unverifiedFields]);if((0,l.useEffect)(()=>{R.id||!0===t.__internal_setActiveInProgress||i(n.signUpUrl)},[]),!R.id)return(0,r.tZ)(p.LoadingCard,{});let T=!!P.emailAddress.value,O=R.verifications?.externalAccount?.status=="verified",q=A({attributes:c,hasEmail:T,activeCommIdentifierType:F,signUp:R,isProgressiveSignUp:w,legalConsentRequired:s.signUp.legal_consent_enabled});!function(e,t){if(t){let i=!!t.emailAddress,r=t.verifications?.emailAddress?.status==="verified",a=t.verifications?.phoneNumber?.status==="verified",l=t.verifications?.externalAccount?.status==="verified",n=t.verifications?.web3Wallet?.status==="verified",s=null!==t.legalAcceptedAt;i&&r&&delete e.emailAddress,a&&delete e.phoneNumber,(l||n)&&delete e.password,t.firstName&&delete e.firstName,t.lastName&&delete e.lastName,t.username&&delete e.username,s&&delete e.legalAccepted,Object.entries(e).forEach(([t,i])=>{i&&!i.required&&delete e[t]})}}(q,R);let B=s.authenticatableSocialStrategies,x=async r=>{r.preventDefault();let a=Object.entries(q).reduce((e,[t,i])=>[...e,...i&&P[t]?[P[t]]:[]],[]);E&&a.push({id:"unsafeMetadata",value:E});let l=!!a.find(e=>"emailAddress"===e.id)?.value,n=!!a.find(e=>"phoneNumber"===e.id)?.value;return R.missingFields.includes("email_address")&&R.missingFields.includes("phone_number")&&!l&&!n&&v(c,w)&&(a.push(P.emailAddress),a.push(P.phoneNumber)),e.setLoading(),e.setError(void 0),R.update((0,h.ni)(a)).then(e=>(0,N.v)({signUp:e,verifyEmailPath:"./verify-email-address",verifyPhonePath:"./verify-phone-number",handleComplete:()=>t.setActive({session:e.createdSessionId,redirectUrl:y}),navigate:i})).catch(t=>(0,h.S3)(t,a,e.setError)).finally(()=>e.setIdle())},M=v(c,w),D=!O&&B.length>0,X=k?(0,d.localizationKeys)("signUp.legalConsent.continue.title"):(0,d.localizationKeys)("signUp.continue.title"),H=k?(0,d.localizationKeys)("signUp.legalConsent.continue.subtitle"):(0,d.localizationKeys)("signUp.continue.subtitle");return(0,r.tZ)(d.Flow.Part,{part:"complete",children:(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(p.Header.Title,{localizationKey:X}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:H})]}),(0,r.tZ)(p.Card.Alert,{children:e.error}),(0,r.tZ)(d.Flex,{direction:"col",elementDescriptor:d.descriptors.main,gap:8,children:(0,r.BX)(p.SocialButtonsReversibleContainerWithDivider,{children:[D&&!k&&(0,r.tZ)(C,{enableOAuthProviders:D,enableWeb3Providers:!1,continueSignUp:!0}),(0,r.tZ)(b,{handleSubmit:x,fields:q,formState:P,onlyLegalAcceptedMissing:k,canToggleEmailPhone:M,handleEmailPhoneToggle:e=>{v(c,w)&&K(e)}})]})})]}),(0,r.tZ)(p.Card.Footer,{children:L?null:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.continue.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.continue.actionLink"),to:L?"../../":t.buildUrlWithAuth(S)})]})})]})})});var I=i(8969);let Z=(0,I.sN)(I.L);var R=i(753),z=i(4029),L=i(4229),w=i(3234),F=i(3610);let K=()=>{let e=(0,a.cL)(),t=(0,m.v)(),{navigate:i}=(0,u.useRouter)(),{signInUrl:l,waitlistUrl:n}=(0,o.useSignUpContext)(),s=(0,w.H)(),{userSettings:c}=(0,o.useEnvironment)(),{mode:h}=c.signUp,f=async()=>{await i(e.buildUrlWithAuth(n))},g=h===R.ci.RESTRICTED?(0,d.localizationKeys)("signUp.restrictedAccess.subtitle"):(0,d.localizationKeys)("signUp.restrictedAccess.subtitleWaitlist");return(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(d.Icon,{icon:F.gO,sx:e=>({margin:"auto",width:e.sizes.$10,height:e.sizes.$10})}),(0,r.tZ)(p.Header.Title,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.title")}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:g})]}),(0,r.tZ)(p.Card.Alert,{children:t.error}),h===R.ci.RESTRICTED&&s&&(0,r.tZ)(d.Flex,{direction:"col",gap:4,children:(0,r.tZ)(d.Button,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.blockButton__emailSupport"),onClick:()=>{window.location.href=`mailto:${s}`}})}),h===R.ci.WAITLIST&&(0,r.tZ)(d.Flex,{direction:"col",gap:4,children:(0,r.tZ)(d.Button,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.blockButton__joinWaitlist"),onClick:f})})]}),(0,r.tZ)(p.Card.Footer,{children:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.actionLink"),to:e.buildUrlWithAuth(l)})]})})]})},P=(0,I.sN)((0,p.withCardStateProvider)(function(){let e=(0,m.v)(),t=(0,a.cL)(),i=(0,L._m)(),n=(0,o.useCoreSignUp)(),{showOptionalFields:s}=(0,d.useAppearance)().parsedLayout,{userSettings:c}=(0,o.useEnvironment)(),{navigate:g}=(0,u.useRouter)(),{attributes:_}=c,{setActive:y}=(0,a.cL)(),S=(0,o.useSignUpContext)(),E=!!l.useContext(o.SignInContext),{afterSignUpUrl:I,signInUrl:Z,unsafeMetadata:w}=S,F=!!(S.isCombinedFlow&&E),[P,k]=l.useState(U(_,c.signUp.progressive)),{t:T,locale:O}=(0,d.useLocalizations)(),q=S.initialValues||{},[B,x]=l.useState(!1),{userSettings:{passwordSettings:M,usernameSettings:D}}=(0,o.useEnvironment)(),{mode:X}=c.signUp,H={firstName:(0,h.Yp)("firstName",n.firstName||q.firstName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,h.Yp)("lastName",n.lastName||q.lastName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,h.Yp)("emailAddress",n.emailAddress||q.emailAddress||"",{type:"email",label:(0,d.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,h.Yp)("username",n.username||q.username||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__username"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,h.fq)(e,{t:T,locale:O,usernameSettings:D})}),phoneNumber:(0,h.Yp)("phoneNumber",n.phoneNumber||q.phoneNumber||"",{type:"tel",label:(0,d.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),legalAccepted:(0,h.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:c.signUp.legal_consent_enabled||!1}),password:(0,h.Yp)("password","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__password"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0,buildErrorMessage:e=>(0,h.GM)(e,{t:T,locale:O,passwordSettings:M})}),ticket:(0,h.Yp)("ticket",(0,z.X)("__clerk_ticket")||(0,z.X)("__clerk_invitation_token")||"")},V=!!H.ticket.value,W=!!H.emailAddress.value,Y=c.signUp.progressive,j=A({attributes:_,hasTicket:V,hasEmail:W,activeCommIdentifierType:P,isProgressiveSignUp:Y,legalConsentRequired:c.signUp.legal_consent_enabled}),G=()=>{H.ticket.value&&(i.setLoading(),e.setLoading(),n.create({strategy:"ticket",ticket:H.ticket.value}).then(e=>(H.emailAddress.setValue(e.emailAddress||""),"missing_requirements"===e.status&&x(!0),(0,N.v)({signUp:e,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>((0,z.x)("__clerk_ticket"),(0,z.x)("__clerk_invitation_token"),y({session:e.createdSessionId,redirectUrl:I})),navigate:g}))).catch(t=>{H.ticket.setValue(""),(0,h.S3)(t,[],e.setError)}).finally(()=>{i.setIdle(),e.setIdle()}))};l.useLayoutEffect(()=>{G()},[]),l.useEffect(()=>{(async function(){let t=n.verifications.externalAccount.error;if(t){switch(t.code){case R.O1.NOT_ALLOWED_TO_SIGN_UP:case R.O1.OAUTH_ACCESS_DENIED:case R.O1.NOT_ALLOWED_ACCESS:case R.O1.SAML_USER_ATTRIBUTE_MISSING:case R.O1.OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:case R.O1.USER_LOCKED:case R.O1.ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:case R.O1.ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:case R.O1.ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:case R.O1.SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:case R.O1.ORGANIZATION_MEMBERSHIP_QUOTA_EXCEEDED_FOR_SSO:case R.O1.CAPTCHA_INVALID:case R.O1.FRAUD_DEVICE_BLOCKED:case R.O1.FRAUD_ACTION_BLOCKED:e.setError(t);break;default:e.setError("Unable to complete action at this time. If the problem persists please contact support.")}await n.create({})}})()},[]);let $=async t=>{let i;t.preventDefault();let r=Object.entries(j).reduce((e,[t,i])=>(e.push(...i&&H[t]?[H[t]]:[]),e),[]);if(w&&r.push({id:"unsafeMetadata",value:w}),j.ticket){let e=()=>{};r.push({id:"strategy",value:"ticket",clearFeedback:e,setValue:e,onChange:e,setError:e})}let a=!!r.find(e=>"emailAddress"===e.id)?.value,l=!!r.find(e=>"phoneNumber"===e.id)?.value;!a&&!l&&v(_,Y)&&(r.push(H.emailAddress),r.push(H.phoneNumber)),e.setLoading(),e.setError(void 0);let s=S.ssoCallbackUrl,o=S.afterSignUpUrl||"/";return(j.ticket?n.upsert((0,h.ni)(r)):n.create((0,h.ni)(r))).then(e=>(0,N.v)({signUp:e,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>y({session:e.createdSessionId,redirectUrl:I}),navigate:g,redirectUrl:s,redirectUrlComplete:o})).catch(t=>(0,h.S3)(t,r,e.setError)).finally(()=>e.setIdle())};if(i.isLoading)return(0,r.tZ)(p.LoadingCard,{});let Q=v(_,Y),J=Object.entries(j).filter(([e,t])=>s||t?.required),ee=function(e){let{authenticatableSocialStrategies:t,web3FirstFactors:i}=e;return e.hasValidAuthFactor||!t.length&&!i.length}(c)&&J.length>0,et=(!V||B)&&c.authenticatableSocialStrategies.length>0,ei=!V&&c.web3FirstFactors.length>0;return X===R.ci.PUBLIC||V?(0,r.tZ)(d.Flow.Part,{part:"start",children:(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(p.Header.Title,{localizationKey:F?(0,d.localizationKeys)("signUp.start.titleCombined"):(0,d.localizationKeys)("signUp.start.title")}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:F?(0,d.localizationKeys)("signUp.start.subtitleCombined"):(0,d.localizationKeys)("signUp.start.subtitle")})]}),(0,r.tZ)(p.Card.Alert,{children:e.error}),(0,r.BX)(d.Flex,{direction:"col",elementDescriptor:d.descriptors.main,gap:6,children:[(0,r.BX)(p.SocialButtonsReversibleContainerWithDivider,{children:[(et||ei)&&(0,r.tZ)(C,{enableOAuthProviders:et,enableWeb3Providers:ei,continueSignUp:B,legalAccepted:!!H.legalAccepted.checked||void 0}),ee&&(0,r.tZ)(b,{handleSubmit:$,fields:j,formState:H,canToggleEmailPhone:Q,handleEmailPhoneToggle:e=>{v(_,Y)&&k(e)}})]}),!ee&&(0,r.tZ)(f.S,{})]})]}),(0,r.tZ)(p.Card.Footer,{children:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.start.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.start.actionLink"),to:F?"../":t.buildUrlWithAuth(Z)})]})})]})}):(0,r.tZ)(K,{})})),k=e=>{let{afterSignUpUrl:t}=(0,o.useSignUpContext)(),{setActive:i}=(0,a.cL)(),{navigate:l}=(0,u.useRouter)();return(0,r.tZ)(p.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,resendButton:e.resendButton,onCodeEntryFinishedAction:(r,a,n)=>{e.attempt(r).then(async e=>(await a(),(0,N.v)({signUp:e,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",continuePath:"../continue",handleComplete:()=>i({session:e.createdSessionId,redirectUrl:t}),navigate:l}))).catch(e=>n(e))},onResendCodeClicked:e.prepare,safeIdentifier:e.safeIdentifier,onIdentityPreviewEditClicked:()=>l("../")})},T=()=>{let e=(0,o.useCoreSignUp)(),t=(0,p.useCardState)(),i=e.verifications.emailAddress.status,a=!e.status||"verified"===i;return(0,L.ib)(a?void 0:()=>e.prepareEmailAddressVerification({strategy:"email_code"}).catch(e=>(0,h.S3)(e,[],t.setError)),{name:"prepare",strategy:"email_code",number:e.emailAddress},{staleTime:100}),(0,r.tZ)(d.Flow.Part,{part:"emailCode",children:(0,r.tZ)(k,{cardTitle:(0,d.localizationKeys)("signUp.emailCode.title"),cardSubtitle:(0,d.localizationKeys)("signUp.emailCode.subtitle"),inputLabel:(0,d.localizationKeys)("signUp.emailCode.formSubtitle"),resendButton:(0,d.localizationKeys)("signUp.emailCode.resendButton"),prepare:()=>{if(!a)return e.prepareEmailAddressVerification({strategy:"email_code"}).catch(e=>(0,h.S3)(e,[],t.setError))},attempt:t=>e.attemptEmailAddressVerification({code:t}),safeIdentifier:e.emailAddress})})};var O=i(4814);let q=()=>{let{t:e}=(0,d.useLocalizations)(),t=(0,o.useCoreSignUp)(),i=(0,o.useSignUpContext)(),{afterSignUpUrl:n}=i,s=(0,m.v)(),{navigate:c}=(0,u.useRouter)(),{setActive:f}=(0,a.cL)(),[g,b]=l.useState(!1),{startEmailLinkFlow:_,cancelEmailLinkFlow:y}=(0,O.E)(t);l.useEffect(()=>{A()},[]);let A=()=>_({redirectUrl:i.emailLinkRedirectUrl}).then(e=>U(e)).catch(e=>{(0,h.S3)(e,[],s.setError)}),U=async t=>{let i=t.verifications.emailAddress;"expired"===i.status?s.setError(e((0,d.localizationKeys)("formFieldError__verificationLinkExpired"))):i.verifiedFromTheSameClient()?b(!0):await (0,N.v)({signUp:t,continuePath:"../continue",verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",handleComplete:()=>f({session:t.createdSessionId,redirectUrl:n}),navigate:c})};return g?(0,r.tZ)(I.Ej,{title:(0,d.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,d.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitleNewTab"),status:"verified_switch_tab"}):(0,r.tZ)(d.Flow.Part,{part:"emailLink",children:(0,r.tZ)(p.VerificationLinkCard,{cardTitle:(0,d.localizationKeys)("signUp.emailLink.title"),cardSubtitle:(0,d.localizationKeys)("signUp.emailLink.subtitle"),formTitle:(0,d.localizationKeys)("signUp.emailLink.formTitle"),formSubtitle:(0,d.localizationKeys)("signUp.emailLink.formSubtitle"),resendButton:(0,d.localizationKeys)("signUp.emailLink.resendButton"),onResendCodeClicked:()=>{y(),A()},safeIdentifier:t.emailAddress})})},B=(0,p.withCardStateProvider)(()=>{let{userSettings:e}=(0,o.useEnvironment)(),{attributes:t}=e;return t.email_address?.verifications?.includes("email_link")?(0,r.tZ)(q,{}):(0,r.tZ)(T,{})}),x=(0,p.withCardStateProvider)(()=>{let e=(0,o.useCoreSignUp)(),t=(0,p.useCardState)(),i=e.verifications.phoneNumber.status,a=!e.status||"verified"===i;return(0,L.ib)(a?void 0:()=>e.preparePhoneNumberVerification({strategy:"phone_code"}).catch(e=>(0,h.S3)(e,[],t.setError)),{name:"signUp.preparePhoneNumberVerification",strategy:"phone_code",number:e.phoneNumber},{staleTime:100}),(0,r.tZ)(d.Flow.Part,{part:"phoneCode",children:(0,r.tZ)(k,{cardTitle:(0,d.localizationKeys)("signUp.phoneCode.title"),cardSubtitle:(0,d.localizationKeys)("signUp.phoneCode.subtitle"),resendButton:(0,d.localizationKeys)("signUp.phoneCode.resendButton"),prepare:()=>{if(!a)return e.preparePhoneNumberVerification({strategy:"phone_code"}).catch(e=>(0,h.S3)(e,[],t.setError))},attempt:t=>e.attemptPhoneNumberVerification({code:t}),safeIdentifier:e.phoneNumber})})}),M=()=>(0,r.tZ)(x,{});function D(){let e=(0,a.cL)();return l.useEffect(()=>{e.redirectToSignUp()},[]),null}function X(){(0,c.z)();let{__internal_setComponentNavigationContext:e}=(0,a.cL)(),{navigate:t,indexPath:i}=(0,u.useRouter)(),p=(0,o.useSignUpContext)();return l.useEffect(()=>e?.({indexPath:i,navigate:t}),[i,t]),(0,r.tZ)(d.Flow.Root,{flow:"signUp",children:(0,r.BX)(u.Switch,{children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(B,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(M,{})}),(0,r.tZ)(u.Route,{path:"sso-callback",children:(0,r.tZ)(Z,{signUpUrl:p.signUpUrl,signInUrl:p.signInUrl,signUpForceRedirectUrl:p.afterSignUpUrl,signInForceRedirectUrl:p.afterSignInUrl,secondFactorUrl:p.secondFactorUrl,continueSignUpUrl:"../continue",verifyEmailAddressUrl:"../verify-email-address",verifyPhoneNumberUrl:"../verify-phone-number"})}),(0,r.tZ)(u.Route,{path:"verify",children:(0,r.tZ)(s.$,{redirectUrlComplete:p.afterSignUpUrl,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number"})}),(0,r.BX)(u.Route,{path:"continue",children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(B,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(M,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(E,{})})]}),(0,r.tZ)(u.Route,{path:"tasks",children:(0,r.tZ)(n.x7,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(P,{})}),(0,r.tZ)(u.Route,{children:(0,r.tZ)(D,{})})]})})}X.displayName="SignUp";let H=(0,o.withCoreSessionSwitchGuard)(X),V=e=>{let t={signInUrl:`/${u.VIRTUAL_ROUTER_BASE_PATH}/sign-in`,waitlistUrl:`/${u.VIRTUAL_ROUTER_BASE_PATH}/waitlist`,...e};return(0,r.tZ)(u.Route,{path:"sign-up",children:(0,r.tZ)(o.SignUpContext.Provider,{value:{componentName:"SignUp",...t,routing:"virtual",mode:"modal"},children:(0,r.tZ)("div",{children:(0,r.tZ)(H,{...t,routing:"virtual"})})})})}},6052:function(e,t,i){i.r(t),i.d(t,{completeSignUpFlow:()=>r.v});var r=i(5756)}}]);