"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["33"],{51991:function(e,t,a){a.r(t),a.d(t,{PlanDetails:()=>p}),a(65223);var n=a(88635),i=a(83799),r=a(69144),l=a(8969),o=a(43812),c=a(43064),s=a(77718),d=a(50043);let p=e=>(0,n.tZ)(o.SubscriberTypeContext.Provider,{value:e.subscriberType||"user",children:(0,n.tZ)(o.PlansContextProvider,{children:(0,n.tZ)(u,{...e})})}),u=e=>{let{plan:t,onSubscriptionCancel:a,portalRoot:p,planPeriod:u="month"}=e,h=(0,i.cL)(),{organization:g}=(0,i.o8)(),[D,b]=(0,r.useState)(!1),[x,y]=(0,r.useState)(!1),[B,Z]=(0,r.useState)(),[v,S]=(0,r.useState)(u),{setIsOpen:C}=(0,s.useDrawerContext)(),{activeOrUpcomingSubscription:k,revalidate:w,buttonPropsForPlan:T,isDefaultPlanImplicitlyActiveOrUpcoming:z}=(0,o.usePlansContext)(),f=(0,o.useSubscriberTypeContext)(),P=(0,l.N2)(e=>e({permission:"org:sys_billing:manage"})||"user"===f);if(!t)return null;let K=k(t),$=()=>{C&&C(!1)},F=t.features,L=F.length>0,X=async()=>{K&&(Z(void 0),y(!0),await K.cancel({orgId:"org"===f?null==g?void 0:g.id:void 0}).then(()=>{y(!1),null==a||a(),$()}).catch(e=>{(0,d.S3)(e,[],Z),y(!1)}))},_=e=>{$();let a=(null==e?void 0:e.planPeriod)||v;"annual"===a&&0===t.annualMonthlyAmount&&(a="month"),h.__internal_openCheckout({planId:t.id,planPeriod:a,subscriberType:f,onSubscriptionComplete:()=>{w()},portalRoot:p})};return(0,n.BX)(s.Drawer.Content,{children:[(0,n.tZ)(s.Drawer.Header,{sx:e=>L?null:{flex:1,borderBottomWidth:0,background:e.colors.$colorBackground},children:(0,n.tZ)(m,{plan:t,subscription:K,planPeriod:v,setPlanPeriod:S,closeSlot:(0,n.tZ)(s.Drawer.Close,{})})}),L?(0,n.BX)(s.Drawer.Body,{children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:(0,c.localizationKeys)("commerce.availableFeatures"),colorScheme:"secondary",sx:e=>({padding:e.space.$4,paddingBottom:0})}),(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesList,as:"ul",role:"list",sx:e=>({display:"grid",rowGap:e.space.$6,padding:e.space.$4,margin:0}),children:F.map(e=>(0,n.BX)(c.Box,{elementDescriptor:c.descriptors.planDetailFeaturesListItem,as:"li",sx:e=>({display:"flex",alignItems:"baseline",gap:e.space.$3}),children:[e.avatarUrl?(0,n.tZ)(s.Avatar,{size:e=>24,title:e.name,initials:e.name[0],rounded:!1,imageUrl:e.avatarUrl}):null,(0,n.BX)(c.Span,{elementDescriptor:c.descriptors.planDetailFeaturesListItemContent,children:[(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemTitle,colorScheme:"body",sx:e=>({fontWeight:e.fontWeights.$medium}),children:e.name}),e.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeaturesListItemDescription,colorScheme:"secondary",sx:e=>({marginBlockStart:e.space.$0x25}),children:e.description}):null]})]},e.id))})]}):null,t.isDefault&&z?null:(0,n.tZ)(s.Drawer.Footer,{children:K?K.canceledAt?(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...T({plan:t}),onClick:()=>_()}):(0,n.BX)(c.Col,{gap:4,children:[K&&"month"===K.planPeriod&&t.annualMonthlyAmount>0?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>_({planPeriod:"annual"}),localizationKey:(0,c.localizationKeys)("commerce.switchToAnnual")}):null,K&&"annual"===K.planPeriod?(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"secondary",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>_({planPeriod:"month"}),localizationKey:(0,c.localizationKeys)("commerce.switchToMonthly")}):null,(0,n.tZ)(c.Button,{block:!0,variant:"bordered",colorScheme:"danger",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>b(!0),localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}):(0,n.tZ)(c.Button,{block:!0,textVariant:"buttonLarge",...T({plan:t}),onClick:()=>_()})}),K?(0,n.BX)(s.Drawer.Confirmation,{open:D,onOpenChange:b,actionsSlot:(0,n.BX)(n.HY,{children:[!x&&(0,n.tZ)(c.Button,{variant:"ghost",size:"sm",textVariant:"buttonLarge",isDisabled:!P,onClick:()=>{Z(void 0),b(!1)},localizationKey:(0,c.localizationKeys)("commerce.keepSubscription")}),(0,n.tZ)(c.Button,{variant:"solid",colorScheme:"danger",size:"sm",textVariant:"buttonLarge",isLoading:x,isDisabled:!P,onClick:()=>{Z(void 0),b(!1),X()},localizationKey:(0,c.localizationKeys)("commerce.cancelSubscription")})]}),children:[(0,n.BX)(c.Heading,{elementDescriptor:c.descriptors.drawerConfirmationTitle,as:"h2",textVariant:"h3",children:["Cancel ","upcoming"===K.status?"upcoming ":"",K.plan.name," Subscription?"]}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.drawerConfirmationDescription,colorScheme:"secondary",children:"upcoming"===K.status?(0,n.tZ)(n.HY,{children:"You will not be charged for this subscription."}):(0,n.BX)(n.HY,{children:["You can keep using “",K.plan.name,"” features until"," ",(0,d.p6)(new Date(K.periodEnd)),", after which you will no longer have access."]})}),B&&(0,n.tZ)(s.Alert,{colorScheme:"danger",children:"string"==typeof B?B:B.message})]}):null]})},m=r.forwardRef((e,t)=>{let{plan:a,subscription:i,closeSlot:r,planPeriod:l,setPlanPeriod:d}=e,{captionForSubscription:p,isDefaultPlanImplicitlyActiveOrUpcoming:u,subscriptions:m}=(0,o.usePlansContext)(),h=u&&a.isDefault,g=!!i||h;return(0,n.BX)(c.Box,{ref:t,elementDescriptor:c.descriptors.planDetailHeader,sx:e=>({width:"100%",padding:e.space.$4,position:"relative"}),children:[r?(0,n.tZ)(c.Box,{sx:e=>({position:"absolute",top:e.space.$2,right:e.space.$2}),children:r}):null,a.avatarUrl?(0,n.tZ)(s.Avatar,{boxElementDescriptor:c.descriptors.planDetailAvatar,size:e=>40,title:a.name,initials:a.name[0],rounded:!1,imageUrl:a.avatarUrl,sx:e=>({marginBlockEnd:e.space.$3})}):null,(0,n.BX)(c.Box,{sx:e=>({paddingRight:e.space.$10}),children:[(0,n.BX)(c.Flex,{gap:2,align:"center",children:[(0,n.tZ)(c.Heading,{elementDescriptor:c.descriptors.planDetailTitle,as:"h2",textVariant:"h2",children:a.name}),g?(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailBadgeContainer,children:(null==i?void 0:i.status)==="active"||h&&0===m.length?(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__activePlan"),colorScheme:"secondary"}):(0,n.tZ)(c.Badge,{elementDescriptor:c.descriptors.planDetailBadge,localizationKey:(0,c.localizationKeys)("badge__upcomingPlan"),colorScheme:"primary"})}):null]}),a.description?(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailDescription,variant:"subtitle",colorScheme:"secondary",sx:e=>({marginTop:e.space.$1}),children:a.description}):null]}),(0,n.tZ)(c.Flex,{elementDescriptor:c.descriptors.planDetailFeeContainer,align:"center",wrap:"wrap",sx:e=>({marginTop:e.space.$3,columnGap:e.space.$1x5}),children:(0,n.BX)(n.HY,{children:[(0,n.BX)(c.Text,{elementDescriptor:c.descriptors.planDetailFee,variant:"h1",colorScheme:"body",children:[a.currencySymbol,i&&"annual"===i.planPeriod||"annual"===l?a.annualMonthlyAmountFormatted:a.amountFormatted]}),(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailFeePeriod,variant:"caption",colorScheme:"secondary",sx:e=>({textTransform:"lowercase",":before":{content:'"/"',marginInlineEnd:e.space.$1}}),localizationKey:(0,c.localizationKeys)("commerce.month")})]})}),!i||"month"===i.planPeriod&&a.annualMonthlyAmount>0?(0,n.tZ)(c.Box,{elementDescriptor:c.descriptors.planDetailPeriodToggle,sx:e=>({display:"flex",marginTop:e.space.$3}),children:(0,n.tZ)(s.Switch,{isChecked:"annual"===l,onChange:e=>d(e?"annual":"month"),label:(0,c.localizationKeys)("commerce.billedAnnually")})}):null,!!i&&(0,n.tZ)(c.Text,{elementDescriptor:c.descriptors.planDetailCaption,variant:"caption",localizationKey:p(i),colorScheme:"secondary",sx:e=>({marginTop:e.space.$3})})]})})}}]);